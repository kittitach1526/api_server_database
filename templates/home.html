{% extends "index.html" %}
{% block content %}
<nav class="navbar shadow-box nav">
     <div class="container-fluid">
         <a class="navbar-brand">
             <img class="logo" src="/static/images/logo.png" alt="">
         </a>
         <div class="d-flex align-items-center">
             <div class="mx-4">
                 {% if user %}
                     {{ user["username"] }}
                 {% endif%}
             </div>
             <form action="/logout" method="POST">
               <button class="btn btn-light" type="submit">logout</button>
             </form>
         </div>
     </div>
 </nav>

<section class="container my-5">
     <div class="d-flex justify-content-between align-items-end">
         <div class="title">
             รายผลการประเมิน
         </div>

         <div class="d-flex">
             <div class="input-group mx-3">
                 <label class="input-group-text" for="inputGroupSelect01">เหตุกาณ์:</label>
                 <select class="form-select" id="inputGroupSelect01">
                     <option value="0">ทั้งหมด</option>
                     <option value="1">ออกตัว</option>
                     <option value="2">เข้าโค้ง</option>
                     <option value="3">เบรก</option>
                 </select>
             </div>

             <div class="input-group mx-3">
                 <label class="input-group-text" for="inputGroupSelect02">สายรถไฟฟ้า:</label>
                 <select class="form-select" id="inputGroupSelect02">
                     <option value="0">ทั้งหมด</option>
                     {% for r in railways %}
                     <option value="{{ r["id_railway_type"] }}">{{ r["railway_type"] }}</option>
                     {% endfor %}
                 </select>
             </div>
         </div>

         <div class="dropdown">
             <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown"
                 aria-expanded="false">
                 export
             </button>
             <ul class="dropdown-menu">
                 <li><a class="dropdown-item" href="#">Excel File</a></li>
                 <li><a class="dropdown-item" href="#">CSV File</a></li>
             </ul>
         </div>
     </div>
     <div class="my-4">
         <div class="table-container">
             <table class="table ">
                 <thead class="table-dark">
                     <tr class="text-center">
                         <th>ลำดับ</th>
                         <th>เหตุการณ์</th>
                         <th>ค่าแกน x</th>
                         <th>ค่าแกน y</th>
                         <th>ค่าแกน z</th>
                         <th>สายรถไฟฟ้า</th>
                         <th>สถานีต้นทาง</th>
                         <th>สถานีปลายทาง</th>
                         <th>วันที่ประเมิน</th>
                         <th>คะแนน</th>
                     </tr>
                 </thead>
                 <tbody>

                    {% for i in range(0,evaluations|length) %}
                     <tr class="text-center">
                          {% set station_start = stations | selectattr('id_station', 'equalto', evaluations[i]["station_start"]) | first %}
                          {% set station_end = stations | selectattr('id_station', 'equalto', evaluations[i]["station_end"]) | first %}
                          {% set railway = railways | selectattr('id_railway_type', 'equalto', station_start["id_railway_type"]) | first %}
                         <td>{{ i+1 }}</td>
                         <td>{{ evaluations[i]["event"] }}</td>
                         <td>{{ evaluations[i]["gyro_x"] }}</td>
                         <td>{{ evaluations[i]["gyro_y"] }}</td>
                         <td>{{ evaluations[i]["gyro_z"] }}</td>
                         <td>{{ railway["railway_type"] }}</td>
                         <td>{{ station_start["station_name"] }}</td>
                         <td>{{ station_end["station_name"] }}</td>
                         <td>{{ evaluations[i]["evaluation_date"] }}</td>
                         <td>{{ evaluations[i]["evaluation_score"] }}</td>
                     </tr>
                     {% endfor %}
                 </tbody>
             </table>
         </div>
     </div>
 </section>
 {% endblock %}